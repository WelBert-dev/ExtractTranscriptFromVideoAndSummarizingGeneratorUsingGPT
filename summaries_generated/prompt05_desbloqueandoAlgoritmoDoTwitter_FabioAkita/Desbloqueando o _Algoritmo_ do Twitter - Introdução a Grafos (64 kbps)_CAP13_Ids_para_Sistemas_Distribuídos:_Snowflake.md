# Resumo do Capítulo 13 - "Ids para Sistemas Distribuídos: Snowflake"

## Snowflake: Geração de IDs Únicos para Sistemas Distribuídos
No vídeo, é mencionado o projeto open source do Twitter chamado Snowflake, que foi desenvolvido como parte da solução GraphJet. Em sistemas distribuídos, a geração de IDs únicos é um problema importante. O exemplo dado é o de uma tabela de banco de dados simples em que um campo de ID auto incremental é usado. Esses IDs incrementais podem apresentar problemas de segurança e dificuldades na divisão/particionamento dos IDs. Quando se tem um banco de dados distribuído em vários servidores, dividir os IDs sequencialmente não é escalável. Uma abordagem mais inteligente seria usar IDs únicos como UID (Identificador Único Universal) ou GUID (Globally Unique Identifier), que são números aleatórios de 64 ou 128 bits, ou até mesmo espaços menores, como um endereço MAC de 48 bits de uma placa de rede. No caso do Snowflake, a estratégia de geração de IDs únicos envolve um número aleatório pré-fixado com um timestamp, um identificador do servidor onde o ID está e uma sequência numérica aleatória. Essa abordagem permite agrupar tweets criados em um determinado período de tempo e fornece informações sobre a localização no cluster de servidores, evitando colisões de IDs entre servidores. Os IDs gerados pelo Snowflake são semi-aleatórios e têm uma probabilidade extremamente baixa de colisão prática.

## Outras Estratégias de IDs Únicos em Bancos de Dados Distribuídos
Além do Snowflake, existem outras estratégias para a geração de IDs únicos em bancos de dados distribuídos. Por exemplo, o Cassandra utiliza uma estratégia chamada TimeUUID, que também incorpora um componente de timestamp no ID. Isso facilita a realização de consultas por períodos de tempo e análise de séries temporais (time series) e processamento de eventos. O Amazon DynamoDB utiliza uma chave de partição como identificador único, que é combinada com uma chave de ordenação para ordenar os dados dentro de uma partição. Essas diferentes estratégias de IDs únicos são projetadas para atender a necessidades específicas de bancos de dados distribuídos.

## Consistente Hashing: Balanceamento de Dados em Bancos de Dados Distribuídos
Para garantir um balanceamento adequado de dados em servidores distribuídos, é utilizado um algoritmo chamado Consistent Hashing. Esse algoritmo mapeia as chaves de partição, como o Snowflake do Twitter ou o TimeUUID do Cassandra, em nós virtuais em um anel (ring). Cada nó virtual representa um servidor físico no cluster. À medida que novos nós são adicionados ou removidos do cluster, os intervalos de partição são redistribuídos entre os nós virtuais, garantindo uma distribuição uniforme das chaves de partição. O Consistent Hashing é amplamente utilizado em bancos de dados distribuídos para equilibrar o volume de dados entre os servidores.